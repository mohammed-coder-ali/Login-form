<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>DevFox Community</title>

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #0f0f14;
    color: white;
}

header {
    background: #1a1a22;
    padding: 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.logo {
    font-size: 22px;
    font-weight: bold;
    color: #ff7139;
}

button {
    background: #ff7139;
    border: none;
    padding: 6px 10px;
    border-radius: 6px;
    color: white;
    cursor: pointer;
    margin-top: 5px;
}

input, textarea, select {
    width: 100%;
    padding: 8px;
    margin-top: 8px;
    background: #121212;
    border: none;
    color: white;
    border-radius: 6px;
}

.container {
    max-width: 800px;
    margin: 20px auto;
    padding: 10px;
}

.card {
    background: #1e1e28;
    padding: 20px;
    border-radius: 10px;
    margin-bottom: 20px;
}

.post {
    background: #1e1e28;
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 15px;
}

.small {
    font-size: 13px;
    color: #aaa;
}
</style>
</head>

<body>

<div id="authScreen" class="container">
    <div class="card">
        <h2 style="color:#ff7139;text-align:center;">ðŸ¦Š DevFox</h2>
        <input type="text" id="authUsername" placeholder="Username">
        <input type="password" id="authPassword" placeholder="Password">
        <button onclick="signup()">Sign Up</button>
        <button onclick="login()">Login</button>
    </div>
</div>

<div id="app" style="display:none;">
<header>
    <div class="logo">ðŸ¦Š DevFox</div>
    <div>
        <span id="currentUser"></span>
        <button onclick="logout()">Logout</button>
    </div>
</header>

<div class="container">

<div class="card">
<textarea id="postContent" placeholder="Share something... Use #hashtags"></textarea>

<select id="category">
<option>Web</option>
<option>AI</option>
<option>Swift</option>
<option>Roblox</option>
</select>

<button onclick="addPost()">Post</button>
</div>

<div id="posts"></div>

</div>
</div>

<script>
let users = JSON.parse(localStorage.getItem("devfoxUsers")) || [];
let posts = JSON.parse(localStorage.getItem("devfoxPosts")) || [];
let currentUser = localStorage.getItem("devfoxCurrentUser");

function saveAll() {
localStorage.setItem("devfoxUsers", JSON.stringify(users));
localStorage.setItem("devfoxPosts", JSON.stringify(posts));
localStorage.setItem("devfoxCurrentUser", currentUser);
}

/* AUTH */

function signup() {
const username = authUsername.value.trim();
const password = authPassword.value.trim();

if(!username || !password) return alert("Fill fields");

if(users.find(u => u.username === username))
return alert("Username exists");

users.push({ username, password, rank: "New Dev" });
currentUser = username;
saveAll();
startApp();
}

function login() {
const username = authUsername.value.trim();
const password = authPassword.value.trim();

const user = users.find(u => u.username === username && u.password === password);
if(!user) return alert("Invalid login");

currentUser = username;
saveAll();
startApp();
}

function logout() {
currentUser = null;
localStorage.removeItem("devfoxCurrentUser");
location.reload();
}

/* START */

function startApp() {
authScreen.style.display = "none";
app.style.display = "block";
currentUserDisplay();
renderPosts();
}

function currentUserDisplay(){
const user = users.find(u=>u.username===currentUser);
currentUserSpan = document.getElementById("currentUser");
currentUserSpan.innerText = "@" + currentUser + " ("+user.rank+")";
}

/* POSTS */

function addPost(){
const content = postContent.value.trim();
const category = document.getElementById("category").value;
if(!content) return;

posts.unshift({
id: Date.now(),
author: currentUser,
content,
category,
likes: 0,
comments: [],
timestamp: Date.now()
});

updateRank();
postContent.value="";
saveAll();
renderPosts();
}

function likePost(id){
const post = posts.find(p=>p.id===id);
post.likes++;
saveAll();
renderPosts();
}

function addComment(id){
const input = document.getElementById("comment-"+id);
if(!input.value) return;

const post = posts.find(p=>p.id===id);
post.comments.push({
user: currentUser,
text: input.value
});

input.value="";
saveAll();
renderPosts();
}

/* RANK SYSTEM */

function updateRank(){
const userPosts = posts.filter(p=>p.author===currentUser).length;
const user = users.find(u=>u.username===currentUser);

if(userPosts > 10) user.rank="Senior Dev";
else if(userPosts > 5) user.rank="Active Dev";
else user.rank="New Dev";

saveAll();
}

/* TRENDING (sort by likes) */

function renderPosts(){
const container = document.getElementById("posts");
container.innerHTML="";

let sorted = [...posts].sort((a,b)=>b.likes - a.likes);

sorted.forEach(post=>{
container.innerHTML+=`
<div class="post">
<div class="small">@${post.author} â€¢ ${post.category}</div>
<div>${highlightHashtags(post.content)}</div>
<div class="small">ðŸ”¥ ${post.likes} likes</div>
<button onclick="likePost(${post.id})">Like</button>

<div style="margin-top:10px;">
<input id="comment-${post.id}" placeholder="Comment...">
<button onclick="addComment(${post.id})">Add</button>
${post.comments.map(c=>`<div class="small">@${c.user}: ${c.text}</div>`).join("")}
</div>

</div>
`;
});
}

/* HASHTAG STYLE */

function highlightHashtags(text){
return text.replace(/#(\w+)/g,'<span style="color:#ff7139;">#$1</span>');
}

/* AUTO LOGIN */

if(currentUser){
startApp();
}
</script>

</body>
</html>
